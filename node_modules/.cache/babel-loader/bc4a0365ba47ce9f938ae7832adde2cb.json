{"ast":null,"code":"var _jsxFileName = \"/Users/hagen.handtke/Documents/urban_integration/src/components/CsvGeneration.js\";\nimport React, { useState, useEffect, useReducer } from 'react';\nimport styled from 'styled-components';\nimport { AddButton } from '../styles/Buttons';\nimport { InputText, Warning } from '../styles/InputOutputFields';\nimport { SimpleFlexWrapper, WrapAreas } from '../styles/Wrapper';\nimport { Button, ButtonElement } from '../styles/Buttons';\nimport { generateCsv } from '../services/CsvGenerationService';\nimport { csvPlaceholders } from '../services/Helpers';\nconst unitMapping = {\n  \"background\": \"bg\",\n  \"layer\": \"lay\",\n  \"leaderboard\": \"lb\",\n  \"billboard\": \"bb\",\n  \"sky-left\": \"sky-left\",\n  \"sky-right\": \"sky-right\",\n  \"special-unit\": \"su\",\n  \"medrect\": \"mr\",\n  \"teaser\": \"tsr\",\n  \"above-the-article\": \"ata\",\n  \"below-the-article\": \"bta\",\n  \"post-site-ad\": \"psa\",\n  \"popunder\": \"pu\",\n  \"interstitial\": \"int\"\n};\nObject.freeze(unitMapping);\nconst colBreakPoint = '801px'; // Minus button - -\n\nconst ComponentWrapper = styled.div`\n    display: flex;\n    justify-content: center;\n    margin: 20px 0 ;\n`;\nconst ComponentUnitWrapper = styled.div`\n    display: flex;\n    justify-content: center;\n`;\nconst InputWrapper = styled.div`\n`;\nconst ResetButton = styled(ButtonElement)`\n    background-color: #dc3545;\n    padding: 2px 8px ;\n    margin-left: 25px;\n    border-color: #dc3545;\n    @media(max-width: ${colBreakPoint}) {\n      padding: 0;\n      margin:0;\n      height: 28px;\n    }\n`;\nconst UnitInput = styled(InputText)`\n   margin-bottom:  10px;\n`;\n\nconst WebStiteInput = props => React.createElement(ComponentWrapper, {\n  __source: {\n    fileName: _jsxFileName,\n    lineNumber: 65\n  },\n  __self: this\n}, React.createElement(InputWrapper, {\n  __source: {\n    fileName: _jsxFileName,\n    lineNumber: 66\n  },\n  __self: this\n}, React.createElement(InputText, Object.assign({\n  placeholder: props.placeholder,\n  width: props.width,\n  value: props.value\n}, props, {\n  __source: {\n    fileName: _jsxFileName,\n    lineNumber: 67\n  },\n  __self: this\n}))));\n\nconst UnitWrapper = styled(SimpleFlexWrapper)`\n    @media(max-width: ${colBreakPoint}) {\n        flex-flow: column;\n        justify-content: center;\n        width: 60%;\n    }\n`;\nconst ButtonWrapper = styled(SimpleFlexWrapper)`\n    @media(max-width: ${colBreakPoint}) {\n        margin-top: 50px;\n    }\n`;\n\nconst GenerateButton = props => React.createElement(ButtonWrapper, {\n  justify: props.justify,\n  top: props.top,\n  __source: {\n    fileName: _jsxFileName,\n    lineNumber: 87\n  },\n  __self: this\n}, React.createElement(ButtonElement, Object.assign({\n  bColor: props.bColor\n}, props, {\n  __source: {\n    fileName: _jsxFileName,\n    lineNumber: 88\n  },\n  __self: this\n}), props.name));\n\nconst AddUnits = props => React.createElement(ComponentUnitWrapper, {\n  __source: {\n    fileName: _jsxFileName,\n    lineNumber: 93\n  },\n  __self: this\n}, React.createElement(UnitWrapper, {\n  top: \"20px\",\n  justify: \"space-between\",\n  __source: {\n    fileName: _jsxFileName,\n    lineNumber: 94\n  },\n  __self: this\n}, React.createElement(UnitInput, Object.assign({\n  name: props.pos,\n  placeholder: csvPlaceholders.UNIT,\n  value: props.unit\n}, props, {\n  __source: {\n    fileName: _jsxFileName,\n    lineNumber: 95\n  },\n  __self: this\n})), React.createElement(UnitInput, Object.assign({\n  name: props.pos,\n  placeholder: csvPlaceholders.SIZES,\n  value: props.sizes\n}, props, {\n  __source: {\n    fileName: _jsxFileName,\n    lineNumber: 96\n  },\n  __self: this\n})), React.createElement(UnitInput, Object.assign({\n  name: props.pos,\n  placeholder: csvPlaceholders.PLACEMENT,\n  value: props.placement\n}, props, {\n  __source: {\n    fileName: _jsxFileName,\n    lineNumber: 97\n  },\n  __self: this\n})), React.createElement(ResetButton, Object.assign({\n  name: props.pos,\n  onClick: props.removeUnit\n}, props, {\n  __source: {\n    fileName: _jsxFileName,\n    lineNumber: 98\n  },\n  __self: this\n}), \" Delete  \")));\n\nconst transformUnit = unit => {\n  try {\n    for (var _unit in unitMapping) {\n      unit = unit.replace(_unit, unitMapping[unit]);\n    }\n  } catch (e) {\n    console.log(e);\n  }\n\n  return unit;\n};\n\nconst transformSizes = size => {\n  var resultStr = '';\n\n  if (typeof size === 'string') {\n    resultStr = size.charAt(0).toUpperCase() + size.slice(1);\n  } else {\n    size.forEach(el => {\n      if (!(typeof el === 'string')) {\n        resultStr += el[0] + 'x' + el[1] + ',';\n      } else {\n        resultStr += el.charAt(0).toUpperCase() + el.slice(1) + ',';\n      }\n    });\n  }\n\n  if (resultStr.charAt(resultStr.length - 1) === ',') resultStr = resultStr.substr(0, resultStr.length - 1);\n  return resultStr;\n};\n\nconst CsvGeneration = props => {\n  // const [units, setUnits] = useState([{ unit: '', sizes: '', placement: '', website: '' }]);\n  const [units, dispatch] = useReducer(reducer, [{\n    unit: '',\n    sizes: '',\n    placement: '',\n    website: ''\n  }]);\n  const [website, setWebsite] = useState('');\n  const [unitPrefix, setUnitPrefix] = useState('');\n  const [warInUnitPrefix, setWarInUnitPrefix] = useState(false);\n  const [warInWebsite, setWarInWebsite] = useState(false);\n\n  function reducer(state = [], action) {\n    switch (action.type) {\n      case 'update':\n        return state.map((el, pos) => {\n          return pos != action.pos ? el : action.data;\n        });\n\n      case 'add':\n        return [...state, action.data];\n\n      case 'delete':\n        state.filter((el, pos) => {\n          return pos !== action.pos;\n        });\n        return state.filter((el, pos) => {\n          return pos != action.pos;\n        });\n\n      case 'setAll':\n        return action.data;\n\n      default:\n        throw new Error();\n    }\n  }\n\n  const generate = () => {\n    if (!website) {\n      setWarInWebsite(true);\n    }\n\n    if (!unitPrefix) {\n      setWarInUnitPrefix(true);\n    }\n\n    if (!website || !unitPrefix) return;\n    units.forEach(el => {\n      el.website = website;\n      el.unit = (unitPrefix + el.unit).trim();\n    });\n    generateCsv([...units]);\n  };\n\n  useEffect(() => {\n    if (warInUnitPrefix) if (unitPrefix) setWarInUnitPrefix(false);\n    if (warInWebsite) if (website) setWarInWebsite(false);\n\n    if (props.location.state.slots) {\n      const slots = props.location.state.slots;\n      const _units = [];\n      slots.forEach((el, index) => {\n        var tempOb = {};\n        tempOb.unit = transformUnit(el.unit);\n        tempOb.sizes = transformSizes(el.size);\n        tempOb.placement = '';\n\n        _units.push(tempOb);\n      }); // setUnits(_units);\n\n      dispatch({\n        type: 'setAll',\n        data: _units\n      });\n    }\n  }, []);\n\n  const removeUnit = event => {\n    console.log('delete ', event.target.name);\n    dispatch({\n      type: 'delete',\n      pos: event.target.name\n    });\n  }; // const removeUnit = (event) => {\n  //     const _units = [];\n  //     for (var unitTemp in units) {\n  //         if (unitTemp === event.target.name) {\n  //             continue;\n  //         } else {\n  //             _units.push(units[unitTemp]);\n  //         }\n  //     }\n  //     setUnits(_units);\n  // }\n  // const addUnit = (event) => {\n  //     var _units = [...units];\n  //     _units.push({ unit: '', sizes: '', placement: '' });\n  //     setUnits(_units);\n  // } \n\n\n  const addUnit = event => {\n    dispatch({\n      type: 'add',\n      data: {\n        unit: '',\n        sizes: '',\n        placement: ''\n      }\n    });\n  }; // const unitChanged = (event) => {\n  //     var _unit = units[event.target.name];\n  //     switch (event.target.placeholder) {\n  //         case csvPlaceholders.UNIT:\n  //             _unit.unit = event.target.value;\n  //             break;\n  //         case csvPlaceholders.SIZES:\n  //             _unit.sizes = event.target.value;\n  //             break;\n  //         case csvPlaceholders.PLACEMENT:\n  //             _unit.placement = event.target.value;\n  //             break;\n  //         case csvPlaceholders.PREFIX:\n  //     }\n  //     setUnits(units);\n  //     console.log('äää', units);\n  // } \n\n\n  const unitChanged = event => {\n    // var _unit = units[event.target.name];\n    const action = {\n      type: 'update',\n      pos: event.target.name\n    };\n    const data = {};\n\n    switch (event.target.placeholder) {\n      case csvPlaceholders.UNIT:\n        data.unit = event.target.value;\n        break;\n\n      case csvPlaceholders.SIZES:\n        data.sizes = event.target.value;\n        break;\n\n      case csvPlaceholders.PLACEMENT:\n        data.placement = event.target.value;\n    }\n\n    action.data = data;\n    dispatch(action);\n  };\n\n  return React.createElement(SimpleFlexWrapper, {\n    top: \"30px\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 267\n    },\n    __self: this\n  }, React.createElement(WrapAreas, {\n    adjust: \"true\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 268\n    },\n    __self: this\n  }, React.createElement(WebStiteInput, {\n    value: website,\n    placeholder: csvPlaceholders.WEBSITE,\n    onChange: e => setWebsite(e.target.value),\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 269\n    },\n    __self: this\n  }), React.createElement(Warning, {\n    show: warInWebsite,\n    marginB: \"10px\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 270\n    },\n    __self: this\n  }, \"Website name required\"), React.createElement(WebStiteInput, {\n    value: unitPrefix,\n    placeholder: \"Unit 'prefix-'\",\n    onChange: e => setUnitPrefix(e.target.value),\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 272\n    },\n    __self: this\n  }), React.createElement(Warning, {\n    show: warInUnitPrefix,\n    marginB: \"10px\",\n    top: \"-10\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 273\n    },\n    __self: this\n  }, \"Unit prefix required\"), units.map((ele, index) => React.createElement(AddUnits, {\n    key: ele + index,\n    pos: index,\n    unit: ele.unit,\n    sizes: ele.sizes,\n    placements: ele.placements,\n    onChange: unitChanged,\n    removeUnit: removeUnit,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 276\n    },\n    __self: this\n  }) // <AddUnits key={ele + index} pos={index} unit={ele.unit} sizes={ele.sizes} placements={ele.placements} onChange={(event) => dispatch({ type: 'update', payload: event })} removeUnit={removeUnit} />\n  ), React.createElement(AddButton, {\n    justify: 'center',\n    top: '50px',\n    onClick: addUnit,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 279\n    },\n    __self: this\n  }), React.createElement(GenerateButton, {\n    name: \"Generate\",\n    onClick: generate,\n    top: \"80px\",\n    justify: \"center\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 280\n    },\n    __self: this\n  })));\n};\n\nexport { CsvGeneration };","map":{"version":3,"sources":["/Users/hagen.handtke/Documents/urban_integration/src/components/CsvGeneration.js"],"names":["React","useState","useEffect","useReducer","styled","AddButton","InputText","Warning","SimpleFlexWrapper","WrapAreas","Button","ButtonElement","generateCsv","csvPlaceholders","unitMapping","Object","freeze","colBreakPoint","ComponentWrapper","div","ComponentUnitWrapper","InputWrapper","ResetButton","UnitInput","WebStiteInput","props","placeholder","width","value","UnitWrapper","ButtonWrapper","GenerateButton","justify","top","bColor","name","AddUnits","pos","UNIT","unit","SIZES","sizes","PLACEMENT","placement","removeUnit","transformUnit","_unit","replace","e","console","log","transformSizes","size","resultStr","charAt","toUpperCase","slice","forEach","el","length","substr","CsvGeneration","units","dispatch","reducer","website","setWebsite","unitPrefix","setUnitPrefix","warInUnitPrefix","setWarInUnitPrefix","warInWebsite","setWarInWebsite","state","action","type","map","data","filter","Error","generate","trim","location","slots","_units","index","tempOb","push","event","target","addUnit","unitChanged","WEBSITE","ele","placements"],"mappings":"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","sourcesContent":["import React, { useState, useEffect, useReducer } from 'react';\nimport styled from 'styled-components';\nimport { AddButton } from '../styles/Buttons';\nimport { InputText, Warning } from '../styles/InputOutputFields';\nimport { SimpleFlexWrapper, WrapAreas } from '../styles/Wrapper';\nimport { Button, ButtonElement } from '../styles/Buttons';\nimport { generateCsv } from '../services/CsvGenerationService';\nimport { csvPlaceholders } from '../services/Helpers';\n\n\nconst unitMapping = {\n    \"background\": \"bg\",\n    \"layer\": \"lay\",\n    \"leaderboard\": \"lb\",\n    \"billboard\": \"bb\",\n    \"sky-left\": \"sky-left\",\n    \"sky-right\": \"sky-right\",\n    \"special-unit\": \"su\",\n    \"medrect\": \"mr\",\n    \"teaser\": \"tsr\",\n    \"above-the-article\": \"ata\",\n    \"below-the-article\": \"bta\",\n    \"post-site-ad\": \"psa\",\n    \"popunder\": \"pu\",\n    \"interstitial\": \"int\"\n\n};\n\nObject.freeze(unitMapping);\n\n\nconst colBreakPoint = '801px';\n// Minus button - -\nconst ComponentWrapper = styled.div`\n    display: flex;\n    justify-content: center;\n    margin: 20px 0 ;\n`;\n\n\nconst ComponentUnitWrapper = styled.div`\n    display: flex;\n    justify-content: center;\n`;\nconst InputWrapper = styled.div`\n`;\n\nconst ResetButton = styled(ButtonElement)`\n    background-color: #dc3545;\n    padding: 2px 8px ;\n    margin-left: 25px;\n    border-color: #dc3545;\n    @media(max-width: ${colBreakPoint}) {\n      padding: 0;\n      margin:0;\n      height: 28px;\n    }\n`;\n\nconst UnitInput = styled(InputText)`\n   margin-bottom:  10px;\n`;\n\nconst WebStiteInput = (props) => (\n    <ComponentWrapper>\n        <InputWrapper >\n            <InputText placeholder={props.placeholder} width={props.width} value={props.value} {...props} />\n        </InputWrapper>\n    </ComponentWrapper>\n);\n\nconst UnitWrapper = styled(SimpleFlexWrapper)`\n    @media(max-width: ${colBreakPoint}) {\n        flex-flow: column;\n        justify-content: center;\n        width: 60%;\n    }\n`;\n\nconst ButtonWrapper = styled(SimpleFlexWrapper)`\n    @media(max-width: ${colBreakPoint}) {\n        margin-top: 50px;\n    }\n`;\n\nconst GenerateButton = (props) => (\n    <ButtonWrapper justify={props.justify} top={props.top} >\n        <ButtonElement bColor={props.bColor} {...props} >{props.name}</ButtonElement>\n    </ButtonWrapper>\n);\n\nconst AddUnits = (props) => (\n    <ComponentUnitWrapper>\n        <UnitWrapper top=\"20px\" justify=\"space-between\" >\n            <UnitInput name={props.pos} placeholder={csvPlaceholders.UNIT} value={props.unit} {...props} />\n            <UnitInput name={props.pos} placeholder={csvPlaceholders.SIZES} value={props.sizes} {...props} />\n            <UnitInput name={props.pos} placeholder={csvPlaceholders.PLACEMENT} value={props.placement}   {...props} />\n            <ResetButton name={props.pos} onClick={props.removeUnit}{...props}> Delete  </ResetButton>\n        </UnitWrapper>\n    </ComponentUnitWrapper>\n);\n\nconst transformUnit = (unit) => {\n    try {\n        for (var _unit in unitMapping) {\n            unit = unit.replace(_unit, unitMapping[unit]);\n        }\n    } catch (e) {\n        console.log(e);\n    }\n    return unit;\n}\n\nconst transformSizes = (size) => {\n    var resultStr = '';\n    if (typeof size === 'string') {\n        resultStr = size.charAt(0).toUpperCase() + size.slice(1);\n    } else {\n        size.forEach((el) => {\n            if (!(typeof el === 'string')) {\n                resultStr += el[0] + 'x' + el[1] + ',';\n            } else {\n                resultStr += el.charAt(0).toUpperCase() + el.slice(1) + ',';\n            }\n        })\n    }\n\n    if (resultStr.charAt(resultStr.length - 1) === ',')\n        resultStr = resultStr.substr(0, resultStr.length - 1);\n    return resultStr;\n}\n\nconst CsvGeneration = (props) => {\n    // const [units, setUnits] = useState([{ unit: '', sizes: '', placement: '', website: '' }]);\n    const [units, dispatch] = useReducer(reducer, [{ unit: '', sizes: '', placement: '', website: '' }]);\n    const [website, setWebsite] = useState('');\n    const [unitPrefix, setUnitPrefix] = useState('');\n\n    const [warInUnitPrefix, setWarInUnitPrefix] = useState(false);\n    const [warInWebsite, setWarInWebsite] = useState(false);\n\n\n    function reducer(state = [], action) {\n        switch (action.type) {\n            case 'update':\n                return state.map((el, pos) => { return pos != action.pos ? el : action.data });\n            case 'add':\n                return [...state, action.data];\n            case 'delete':\n                state.filter((el, pos) => {\n                    return pos !== action.pos\n                });\n                return state.filter((el, pos) => { return pos != action.pos });\n            case 'setAll':\n                return action.data;\n            default:\n                throw new Error();\n        }\n    }\n\n\n\n    const generate = () => {\n        if (!website) {\n            setWarInWebsite(true);\n        }\n        if (!unitPrefix) {\n            setWarInUnitPrefix(true);\n        }\n\n        if (!website || !unitPrefix)\n            return;\n        units.forEach(el => {\n            el.website = website;\n            el.unit = (unitPrefix + el.unit).trim();\n        });\n        generateCsv([...units]);\n    }\n\n    useEffect(() => {\n        if (warInUnitPrefix)\n            if (unitPrefix)\n                setWarInUnitPrefix(false);\n        if (warInWebsite)\n            if (website)\n                setWarInWebsite(false);\n\n\n\n        if (props.location.state.slots) {\n            const slots = props.location.state.slots;\n            const _units = [];\n\n            slots.forEach((el, index) => {\n                var tempOb = {};\n                tempOb.unit = transformUnit(el.unit);\n                tempOb.sizes = transformSizes(el.size);\n                tempOb.placement = '';\n                _units.push(tempOb);\n            });\n            // setUnits(_units);\n            dispatch({ type: 'setAll', data: _units });\n\n        }\n    }, []);\n\n    const removeUnit = (event) => {\n        console.log('delete ', event.target.name);\n        dispatch({ type: 'delete', pos: event.target.name });\n    }\n    // const removeUnit = (event) => {\n    //     const _units = [];\n    //     for (var unitTemp in units) {\n    //         if (unitTemp === event.target.name) {\n    //             continue;\n    //         } else {\n    //             _units.push(units[unitTemp]);\n    //         }\n    //     }\n    //     setUnits(_units);\n    // }\n    // const addUnit = (event) => {\n    //     var _units = [...units];\n    //     _units.push({ unit: '', sizes: '', placement: '' });\n    //     setUnits(_units);\n    // } \n\n    const addUnit = (event) => {\n        dispatch({ type: 'add', data: { unit: '', sizes: '', placement: '' } })\n    }\n\n    // const unitChanged = (event) => {\n    //     var _unit = units[event.target.name];\n    //     switch (event.target.placeholder) {\n    //         case csvPlaceholders.UNIT:\n    //             _unit.unit = event.target.value;\n    //             break;\n    //         case csvPlaceholders.SIZES:\n    //             _unit.sizes = event.target.value;\n    //             break;\n    //         case csvPlaceholders.PLACEMENT:\n    //             _unit.placement = event.target.value;\n    //             break;\n    //         case csvPlaceholders.PREFIX:\n    //     }\n    //     setUnits(units);\n    //     console.log('äää', units);\n    // } \n    const unitChanged = (event) => {\n        // var _unit = units[event.target.name];\n        const action = { type: 'update', pos: event.target.name };\n        const data = {};\n        switch (event.target.placeholder) {\n            case csvPlaceholders.UNIT:\n                data.unit = event.target.value;\n                break;\n            case csvPlaceholders.SIZES:\n                data.sizes = event.target.value;\n                break;\n            case csvPlaceholders.PLACEMENT:\n                data.placement = event.target.value;\n        }\n        action.data = data;\n        dispatch(action)\n    }\n    return (\n        <SimpleFlexWrapper top=\"30px\">\n            <WrapAreas adjust=\"true\">\n                <WebStiteInput value={website} placeholder={csvPlaceholders.WEBSITE} onChange={(e) => setWebsite(e.target.value)} />\n                <Warning show={warInWebsite} marginB='10px' >Website name required</Warning>\n\n                <WebStiteInput value={unitPrefix} placeholder=\"Unit 'prefix-'\" onChange={(e) => setUnitPrefix(e.target.value)} />\n                <Warning show={warInUnitPrefix} marginB='10px' top='-10' >Unit prefix required</Warning>\n\n                {units.map((ele, index) => (\n                    <AddUnits key={ele + index} pos={index} unit={ele.unit} sizes={ele.sizes} placements={ele.placements} onChange={unitChanged} removeUnit={removeUnit} />\n                    // <AddUnits key={ele + index} pos={index} unit={ele.unit} sizes={ele.sizes} placements={ele.placements} onChange={(event) => dispatch({ type: 'update', payload: event })} removeUnit={removeUnit} />\n                ))}\n                <AddButton justify={'center'} top={'50px'} onClick={addUnit} />\n                <GenerateButton name={\"Generate\"} onClick={generate} top=\"80px\" justify=\"center\" />\n            </WrapAreas>\n        </SimpleFlexWrapper>\n    );\n}\n\nexport { CsvGeneration };\n"]},"metadata":{},"sourceType":"module"}